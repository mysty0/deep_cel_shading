<div class="chart-container" style="position: relative; height:30vh; width:80vw">
    <canvas id="myChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js" style="width: 200px;"></script>

<a id="debug" style="padding-top: 100px;"></a>
<button onclick="saveCanvas()">Save</button>
<script>
    const ctx = document.getElementById('myChart');

    function saveCanvas() {
        var image = ctx.toDataURL('image/png').replace('image/png', 'image/octet-stream');  // here is the most important part because if you dont replace you will get a DOM 18 exception.
        window.location.href = image; // it will save locally
    }

    function sigmoid(x) {
        return 1 / (1 + Math.exp(-x));
    }

    function tanh(x) {
        // Calculate the numerator and denominator separately
        var numerator = Math.exp(x) - Math.exp(-x);
        var denominator = Math.exp(x) + Math.exp(-x);

        // Return the result of the division
        return numerator / denominator;
    }

    const clamp = (num, min, max) => Math.min(Math.max(num, min), max);

    function smoothStep(x) {
        let edge0 = 0;
        let edge1 = 1;
        let t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
        return t * t * (3.0 - 2.0 * t);
    }

    function relu(x) {
        return Math.max(0, x);
    }

    //makeGraph('sigmoid(x)', sigmoid, -8, 8, 0.5)
    makeGraph('smoothStep(0, 1, x)', smoothStep, -0.5, 1.5, 0.1)
    //makeGraph('relu(x)', relu, -8, 8, 0.5, 0)

    function makeGraph(name, fun, min, max, step, tension = 0.4) {
        const generate = (fun, min, max, step) => {
            var y = []
            var x = []
            for (var i = min; i < max; i += step) {
                y.push(fun(i))
                x.push(parseFloat(i.toFixed(4)))
            }
            return { x: x, y: y }
        }



        var gdata = generate(fun, min, max, step)

        var data = {
            labels: gdata.x,
            datasets: [
                {
                    label: 'sigmoid',
                    data: gdata.y,
                    borderColor: '#EB5E28',
                    tension: tension
                }
            ]
        }

        //document.getElementById('debug').innerText = Object.entries(gdata)

        new Chart(ctx, {
            type: 'line',
            data: data,
            options: {
                responsive: true,
                maintainAspectRatio: true,
                aspectRatio: 1,
                plugins: {
                    title: {
                        display: false,
                        text: 'Chart.js Line Chart - Cubic interpolation mode'
                    },
                    legend: {
                        display: false
                    }
                },
                interaction: {
                    intersect: false,
                },
                elements: {
                    point: {
                        radius: 0
                    }
                },
                xAxes: [{
                    type: 'time',
                    ticks: {
                        autoSkip: true,
                        maxTicksLimit: 20
                    }
                }],
                scales: {
                    x: {
                        display: true,
                        title: {
                            display: true
                        },
                        grid: {
                            tickLength: 8
                        },
                        ticks: {
                            backdropPadding: 1
                        },
                        title: {
                            display: true,
                            text: 'x'
                        },
                    },
                    y: {
                        display: true,
                        title: {
                            display: true,
                            text: name
                        },
                        suggestedMin: -0.5,
                        suggestedMax: 1.5,
                        // ticks: {
                        // // forces step size to be 50 units
                        // stepSize: 0.2
                        // }
                    }
                }
            }
        });
    }
</script>